---
title: "Probability distribution"
---

# Communicating uncertainty about a quantity of interest by a probability distribution  

A graph showing probabilities for different values of an uncertain quantity that has a single true value (e.g. the average exposure for a population). The graph can be plotted in various formats, most commonly a probability density function (PDF), cumulative distribution function (CDF) or complementary cumulative distribution function (CCDF) (see [Section 4.1.4.2 in UC](https://doi.org/10.2903/j.efsa.2019.5520))

```{r}
#| message: false
#| warning: false
#| echo: false
#| fig-width: 7
#| fig-height: 7
library(tidyverse)
library(patchwork)
dist_df <- tibble::tibble(
  p=c(0.5, 0.05, 0.95, 0.25, 0.75, ppoints(300)),
  q=qnorm(p, 3, 2),
  d=dnorm(q, 3,2)
) %>%  tibble::rowid_to_column() 

qntls <- c(0.5, 0.05, 0.95, 0.25, 0.75)

dist_w_df <- dist_df %>% select(rowid, p,q) %>% 
  filter(p %in% qntls) %>%
  pivot_longer(-c(rowid, p)) %>% 
  mutate(p_name=paste0("p_", str_pad(p*100,2, pad="0"))) %>% 
  select(-p,-name) %>% 
  pivot_wider(-rowid, values_from="value", names_from="p_name") %>% 
  mutate(IQR=p_75-p_25)

p1 <- dist_df %>% ggplot(aes(x=q, y=p)) +
  geom_linerange(data=. %>% filter(p %in% qntls),
             aes(xmin=-3, xmax=q), linewidth=0.5, 
             linetype=2, color="grey70")+
  geom_linerange(data=. %>% filter(p %in% qntls),
             aes(ymin=0, ymax=p), linewidth=0.5, 
             linetype=2, color="grey70")+
  geom_line()+
  geom_point(data=. %>% filter(p %in% qntls))+
  coord_cartesian(xlim = c(-3,9), ylim=c(0,1), expand = FALSE)+
  labs(y="Probability")+
  theme_minimal()+
  theme(panel.grid = element_blank())

p2 <- dist_df %>% ggplot(aes(x=q, y=d)) +
  geom_ribbon(data=. %>% filter(p >= 0.05 & p<0.95), 
              aes(ymin=0, ymax=d, fill="90% confidence"),
              alpha=0.5)+
  geom_ribbon(data=. %>% filter(p >= 0.25 & p<0.75), 
              aes(ymin=0, ymax=d, fill="50% confidence"),
              alpha=0.5)+
  geom_linerange(data=. %>% filter(p==0.5),
             aes(ymin=0, ymax=d), linewidth=0.5, 
             linetype=2, color="grey70")+
  geom_line()+
  geom_point(data=. %>% filter(p %in% qntls), aes(y=0))+
  scale_fill_brewer(palette = "Set1")+
  coord_cartesian(xlim = c(-3,9), ylim=c(0,0.3), expand = FALSE)+
  labs(y="Density", fill=NULL)+
  theme_minimal()+
  theme(panel.grid = element_blank())

p3 <-  dist_w_df %>% 
  ggplot() + 
    geom_boxplot(stat="identity", 
      aes(y="one", fill="50% confidence",
        xlower  = p_25, xupper  = p_75, xmiddle = p_50,
        xmin   = p_25 - 1.5 * IQR, 
        xmax   = p_75 + 1.5 * IQR), 
      alpha=0.5, show.legend = FALSE, fatten=1,
      linetype=2, linewidth=0.5, color="grey70")+ 
  geom_boxplot(stat="identity", 
      aes(y="one", 
        xlower  = p_25, xupper  = p_75, xmiddle = p_50,
        xmin   = p_25 - 1.5 * IQR, 
        xmax   = p_75 + 1.5 * IQR), 
      show.legend = FALSE, fatten=0, alpha=0)+
  coord_cartesian(xlim = c(-3,9), expand = FALSE)+
  scale_fill_brewer(palette = "Set1")+
  theme_minimal()+
  theme(axis.line.y = element_blank(),
        axis.title.y  = element_blank(),
        axis.text.y = element_blank(),
        axis.ticks.y  = element_blank(),
        panel.grid = element_blank())
patchwork::wrap_plots(p1,p2,p3, ncol=1, guides="collect") &
  theme(legend.position = "bottom")


```


:::: {.panel-tabset}

## Video

<iframe width="560px" height="320px" allowfullscreen="true" allow="autoplay *" title="Sequence 01_Sub_06,00_1" src="https://lu.instructuremedia.com/embed/d5984fd2-a3bd-4dd6-b594-b6e2ecfc91f1" frameborder="0"></iframe>

## Text

> Remind that implementing UA GD results in different expressions of uncertainty, where a probability distribution is one of them. Explain what is a probability distribution. Give examples when used. Go through some of the recommendations given by the UC GD. 

::::






